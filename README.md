# Windows Forensic Agent - Enhanced Edition

**–í–µ—Ä—Å–∏—è 0.3.0** - Snapshot —Ä–µ–∂–∏–º + —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –¥–µ—Ç–µ–∫—Ü–∏—è —É–≥—Ä–æ–∑  
**–°—Ç–∞—Ç—É—Å:** üü¢ –ê–ª—å—Ñ–∞-–≤–µ—Ä—Å–∏—è —Å –¥–≤—É–º—è —Ä–µ–∂–∏–º–∞–º–∏ —Ä–∞–±–æ—Ç—ã

### ‚úÖ –ù–æ–≤–æ–µ –≤ –≤–µ—Ä—Å–∏–∏ 0.3.0:
- **üéØ Snapshot Mode** - —á–∏—Å—Ç—ã–π —Å–Ω–∏–º–æ–∫ —Å–∏—Å—Ç–µ–º—ã –≤ –æ–¥–Ω–æ–º TXT —Ñ–∞–π–ª–µ –±–µ–∑ –¥–µ—Ç–µ–∫—Ü–∏–∏
- **üåê –ë—Ä–∞—É–∑–µ—Ä–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –∞–Ω–∞–ª–∏–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π, –Ω–∞—Å—Ç—Ä–æ–µ–∫, –∑–∞–≥—Ä—É–∑–æ–∫ (Chrome, Firefox, Edge)
- **üí∞ –î–µ—Ç–µ–∫—Ü–∏—è –∫—Ä–∞–∂–∏ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç** - –ø–æ–∏—Å–∫ –∫–æ—à–µ–ª—å–∫–æ–≤, —Å–µ—Å—Å–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤, stealer –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤  
- **üìà 19 –ø—Ä–∞–≤–∏–ª –¥–µ—Ç–µ–∫—Ü–∏–∏** - —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —É–≥—Ä–æ–∑
- **‚ö° –î–≤—É—Ö—Ä–µ–∂–∏–º–Ω–∞—è —Ä–∞–±–æ—Ç–∞** - —Ä–∞–∑–≤–µ–¥–∫–∞ –ò–õ–ò —Ñ–æ—Ä–µ–Ω–∑–∏–∫ –∞–Ω–∞–ª–∏–∑

–§–æ—Ä–µ–Ω–∑–∏–∫-–∞–≥–µ–Ω—Ç –¥–ª—è Windows —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —á–∏—Å—Ç–æ–π —Ä–∞–∑–≤–µ–¥–∫–∏ –∏ –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —É–≥—Ä–æ–∑.

## üéØ –î–≤–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã

### üì∑ Snapshot Mode (–†–∞–∑–≤–µ–¥–∫–∞)
```powershell
# –ß–∏—Å—Ç—ã–π —Å–Ω–∏–º–æ–∫ —Å–∏—Å—Ç–µ–º—ã - —Ç–æ–ª—å–∫–æ —Ñ–∞–∫—Ç—ã, –Ω–∏–∫–∞–∫–æ–π –¥–µ—Ç–µ–∫—Ü–∏–∏
.\forensic-agent.exe --snapshot-only
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –û–¥–∏–Ω —Ñ–∞–π–ª `system_snapshot.txt` —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å–∏—Å—Ç–µ–º–µ

### üîç Full Forensic Mode (–û—Ö–æ—Ç–∞ –∑–∞ —É–≥—Ä–æ–∑–∞–º–∏)  
```powershell
# –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å –¥–µ—Ç–µ–∫—Ü–∏–µ–π —É–≥—Ä–æ–∑
.\forensic-agent.exe
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 21+ JSON —Ñ–∞–π–ª–æ–≤ + –¥–µ—Ç–µ–∫—Ü–∏—è —É–≥—Ä–æ–∑ + findings.json

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –°–±–æ—Ä –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
- **–°–ª—É–∂–±—ã Windows**: –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–ª—É–∂–±–∞—Ö, –∏—Ö –±–∏–Ω–∞—Ä–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö –∏ —Å—Ç–∞—Ç—É—Å–µ –ø–æ–¥–ø–∏—Å–∏
- **–†–µ–µ—Å—Ç—Ä**: –∞–Ω–∞–ª–∏–∑ –∫–ª—é—á–µ–π –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞, IFEO, LSA –ø–∞–∫–µ—Ç–æ–≤, AppInit DLLs
- **–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á**: –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç—ã—Ö –∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á
- **WMI –ø–æ–¥–ø–∏—Å–∫–∏**: –ø–æ–∏—Å–∫ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö WMI —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π
- **–°–µ—Ç–µ–≤—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**: –ø—Ä–æ–∫—Å–∏, Winsock –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã, –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- **–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã**: –∞–Ω–∞–ª–∏–∑ –∫–æ—Ä–Ω–µ–≤—ã—Ö –∏ CA —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
- **–§–∞–π–ª–æ–≤—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã**: —Ö–µ—à–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö DLL, –Ω–µ–¥–∞–≤–Ω–∏–µ –¥—Ä–∞–π–≤–µ—Ä—ã
- **–ü—Ä–æ—Ü–µ—Å—Å—ã**: –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö —Å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ–º –∞–Ω–æ–º–∞–ª–∏–π
- **üåê –ë—Ä–∞—É–∑–µ—Ä–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –∑–∞–≥—Ä—É–∑–∫–∏ (Chrome, Firefox, Edge, Brave)
- **üí∞ –ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –∫–æ—à–µ–ª—å–∫–∏, —Å–µ—Å—Å–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã, stealer –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã
- **üîí –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: Discord, Telegram, Steam, VPN –∫–ª–∏–µ–Ω—Ç—ã

### –î–µ—Ç–µ–∫—Ü–∏—è —É–≥—Ä–æ–∑
- **–í—ã—Å–æ–∫–∏–π/–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —É—Ä–æ–≤–µ–Ω—å**:
  - –°–ª—É–∂–±—ã —Å –±–∏–Ω–∞—Ä–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏ –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∫–∞—Ç–∞–ª–æ–≥–∞—Ö
  - –ù–µ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ —Å–ª—É–∂–±—ã –≤–Ω–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–∞—Ç–∞–ª–æ–≥–æ–≤
  - –°–∫—Ä—ã—Ç—ã–µ –∑–∞–¥–∞—á–∏ —Å LOLBAS —Ç–µ—Ö–Ω–∏–∫–∞–º–∏
  - LSA –ø–∞–∫–µ—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤–Ω–µ System32
  - IFEO –æ—Ç–ª–∞–¥—á–∏–∫–∏ –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
  - üåê **–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è** —Å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏
  - üåê **–°–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞** (–ø—Ä–æ–∫—Å–∏, –ø–æ–∏—Å–∫–æ–≤–∏–∫–∏)
  - üí∞ **–ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –∫—Ä–∞–∂–∏ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç** (stealer —Å–ª–µ–¥—ã, clipboard –º–æ–Ω–∏—Ç–æ—Ä—ã)

- **–°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å**:
  - AppInit_DLLs –±–µ–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–∏
  - –ù–µ–¥–∞–≤–Ω–∏–µ –Ω–µ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ –¥—Ä–∞–π–≤–µ—Ä—ã
  - –ù–æ–≤—ã–µ –∫–æ—Ä–Ω–µ–≤—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
  - üåê **–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≥—Ä—É–∑–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞**
  - üí∞ **–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –∫–æ—à–µ–ª—å–∫–∞–º**
  - üîí **–ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è —Å–µ—Å—Å–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤**

### –í—ã–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö

**Snapshot Mode:**
- –û–¥–∏–Ω —Ñ–∞–π–ª `system_snapshot.txt` —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å–∏—Å—Ç–µ–º–µ
- –ß–∏—Å—Ç—ã–µ —Ñ–∞–∫—Ç—ã –±–µ–∑ –¥–µ—Ç–µ–∫—Ü–∏–∏ —É–≥—Ä–æ–∑  
- –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è —Ä–∞–∑–≤–µ–¥–∫–∏ –∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏

**Full Forensic Mode:**
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON –¥–ª—è –≤—Å–µ—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
- –§–∞–π–ª findings.json —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∞–Ω–∞–ª–∏–∑–∞
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —É–ø–∞–∫–æ–≤–∫–∞ –≤ ZIP –∞—Ä—Ö–∏–≤
- –õ–æ–≥–∏ –æ—à–∏–±–æ–∫ –≤ errors.log

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```powershell
# –ß–∏—Å—Ç—ã–π —Å–Ω–∏–º–æ–∫ —Å–∏—Å—Ç–µ–º—ã (—Ç–æ–ª—å–∫–æ —Ñ–∞–∫—Ç—ã)
.\forensic-agent.exe --snapshot-only

# –ü–æ–ª–Ω—ã–π —Ñ–æ—Ä–µ–Ω–∑–∏–∫ –∞–Ω–∞–ª–∏–∑ —Å –¥–µ—Ç–µ–∫—Ü–∏–µ–π —É–≥—Ä–æ–∑  
.\forensic-agent.exe

# –ë—ã—Å—Ç—Ä—ã–π —Ä–µ–∂–∏–º –±–µ–∑ —Å–æ–±—ã—Ç–∏–π –∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
.\forensic-agent.exe --fast --no-events --no-certs

# –°–æ–∑–¥–∞–Ω–∏–µ ZIP –∞—Ä—Ö–∏–≤–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è full mode)
.\forensic-agent.exe --zip

# –ö–∞—Å—Ç–æ–º–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–µ—Ç–µ–∫—Ü–∏–∏
.\forensic-agent.exe --rules custom-rules.json

# –£–∫–∞–∑–∞–Ω–∏–µ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞
.\forensic-agent.exe --output "C:\Analysis\case-001"
```

## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏

- `--snapshot-only` - üì∑ **Snapshot mode:** —á–∏—Å—Ç—ã–π —Å–Ω–∏–º–æ–∫ –±–µ–∑ –¥–µ—Ç–µ–∫—Ü–∏–∏ —É–≥—Ä–æ–∑
- `--no-events` - –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Å–±–æ—Ä –∂—É—Ä–Ω–∞–ª–æ–≤ —Å–æ–±—ã—Ç–∏–π
- `--no-certs` - –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Å–±–æ—Ä —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
- `--fast` - –ë—ã—Å—Ç—Ä—ã–π —Ä–µ–∂–∏–º —Å–±–æ—Ä–∞
- `--zip` - –°–æ–∑–¥–∞—Ç—å ZIP –∞—Ä—Ö–∏–≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (—Ç–æ–ª—å–∫–æ full mode)
- `--rules <path>` - –ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–µ—Ç–µ–∫—Ü–∏–∏
- `--output <dir>` - –í—ã—Ö–æ–¥–Ω–æ–π –∫–∞—Ç–∞–ª–æ–≥ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: forensic-collect)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤—ã–≤–æ–¥–∞

**Snapshot Mode (`--snapshot-only`):**
```
forensic-collect/YYYYMMDD-HHMM/
‚îú‚îÄ‚îÄ manifest.json           # –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–±–æ—Ä–µ
‚îî‚îÄ‚îÄ system_snapshot.txt     # üì∑ –ü–æ–ª–Ω—ã–π —Å–Ω–∏–º–æ–∫ —Å–∏—Å—Ç–µ–º—ã –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
```

**Full Forensic Mode (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é):**
```
forensic-collect/YYYYMMDD-HHMM/
‚îú‚îÄ‚îÄ manifest.json             # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ –∏ —Å–±–æ—Ä–µ
‚îú‚îÄ‚îÄ services.json             # –°–ª—É–∂–±—ã Windows
‚îú‚îÄ‚îÄ registry_entries.json     # –ó–∞–ø–∏—Å–∏ —Ä–µ–µ—Å—Ç—Ä–∞
‚îú‚îÄ‚îÄ scheduled_tasks.json      # –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á
‚îú‚îÄ‚îÄ wmi_filters.json          # WMI —Ñ–∏–ª—å—Ç—Ä—ã —Å–æ–±—ã—Ç–∏–π
‚îú‚îÄ‚îÄ wmi_consumers.json        # WMI –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏
‚îú‚îÄ‚îÄ wmi_bindings.json         # WMI –ø—Ä–∏–≤—è–∑–∫–∏
‚îú‚îÄ‚îÄ network_connections.json  # –°–µ—Ç–µ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
‚îú‚îÄ‚îÄ proxy_config.json         # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–∫—Å–∏
‚îú‚îÄ‚îÄ winsock_providers.json    # –ü–æ—Å—Ç–∞–≤—â–∏–∫–∏ Winsock
‚îú‚îÄ‚îÄ certificates.json         # –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
‚îú‚îÄ‚îÄ file_artifacts.json       # –§–∞–π–ª–æ–≤—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã
‚îú‚îÄ‚îÄ processes.json            # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö
‚îú‚îÄ‚îÄ process_anomalies.json    # –ê–Ω–æ–º–∞–ª–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
‚îú‚îÄ‚îÄ browser_extensions.json   # üåê –ë—Ä–∞—É–∑–µ—Ä–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
‚îú‚îÄ‚îÄ browser_settings.json     # üåê –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±—Ä–∞—É–∑–µ—Ä–æ–≤
‚îú‚îÄ‚îÄ browser_downloads.json    # üåê –ó–∞–≥—Ä—É–∑–∫–∏ –±—Ä–∞—É–∑–µ—Ä–æ–≤  
‚îú‚îÄ‚îÄ crypto_theft_artifacts.json # üí∞ –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –∫—Ä–∞–∂–∏ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç
‚îú‚îÄ‚îÄ wallet_files.json         # üí∞ –§–∞–π–ª—ã –∫–æ—à–µ–ª—å–∫–æ–≤
‚îú‚îÄ‚îÄ session_files.json        # üîí –°–µ—Å—Å–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
‚îú‚îÄ‚îÄ findings.json             # üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–µ—Ç–µ–∫—Ü–∏–∏ —É–≥—Ä–æ–∑
‚îú‚îÄ‚îÄ hosts.txt                 # –§–∞–π–ª hosts
‚îî‚îÄ‚îÄ errors.log                # –û—à–∏–±–∫–∏ —Å–±–æ—Ä–∞
```

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Windows 10/11 x64
- –ü—Ä–∞–≤–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –†–∞–±–æ—Ç–∞–µ—Ç –æ—Ñ–ª–∞–π–Ω

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –†–µ–∂–∏–º —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è (–Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç —Å–∏—Å—Ç–µ–º—É)
- –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –±–µ–∑ –ø–∞–Ω–∏–∫–∏
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π

## –°–±–æ—Ä–∫–∞

```powershell
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Rust (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
winget install Rustlang.Rustup

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
$env:PATH += ";$env:USERPROFILE\.cargo\bin"

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ GNU toolchain –¥–ª—è Windows
rustup default stable-x86_64-pc-windows-gnu

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
cargo check

# –°–±–æ—Ä–∫–∞ –≤ —Ä–µ–ª–∏–∑–Ω–æ–º —Ä–µ–∂–∏–º–µ
cargo build --release

# –ò—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª –±—É–¥–µ—Ç –≤ target/release/forensic-agent.exe (~1.7 MB)

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
.\target\release\forensic-agent.exe --help
.\target\release\forensic-agent.exe --fast --no-events --no-certs -o test-run
```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ú–æ–¥—É–ª–∏
- `main.rs` - –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –∏ CLI
- `types.rs` - –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö
- `collectors/` - –ú–æ–¥—É–ª–∏ —Å–±–æ—Ä–∞ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
- `detect/` - –î–≤–∏–∂–æ–∫ –¥–µ—Ç–µ–∫—Ü–∏–∏ –∏ –ø—Ä–∞–≤–∏–ª–∞
- `output/` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–≤–æ–¥–æ–º

### –ü—Ä–∞–≤–∏–ª–∞ –¥–µ—Ç–µ–∫—Ü–∏–∏
–ö–∞–∂–¥–æ–µ –ø—Ä–∞–≤–∏–ª–æ —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Ç—Ä–µ–π—Ç `DetectionRule` —Å –º–µ—Ç–æ–¥–æ–º `evaluate()` –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–∞—Ö–æ–¥–æ–∫.

## –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è

### –°–ø—Ä–∏–Ω—Ç 2
- –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è COM Task Scheduler
- WMI –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ WMI API
- –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–µ–π WinVerifyTrust

### –°–ø—Ä–∏–Ω—Ç 3 (–§–æ—Ä–µ–Ω–∑–∏–∫ "–∑–æ–ª–æ—Ç–æ")
- Shimcache (AppCompatCache) –ø–∞—Ä—Å–∏–Ω–≥
- Amcache.hve –∞–Ω–∞–ª–∏–∑
- Prefetch –ø–∞—Ä—Å–µ—Ä
- LNK —Ñ–∞–π–ª—ã –∞–Ω–∞–ª–∏–∑
- SRUM –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- –ë—ã—Å—Ç—Ä—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞–º—è—Ç–∏

## –ö–æ–Ω—Ç–∞–∫—Ç—ã

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π —Å–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞.
